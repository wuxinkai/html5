<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../css/master.css">
    <script type="text/javascript" src="../js/zepto.min.js"></script>
    <script type="text/javascript" src="../js/iscroll.js"></script>
</head>
<body >
    <div class="c-search consult-search">
        <b></b>
        <input class="white" type="text">
    </div>
    <div class="mark white mark36" id="wrapper">
       <div id="scroller">
           <ul class="tab-btn">
               <li class="active"><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
               <li><span>推荐</span></li>
           </ul>
       </div>
    </div>
    <div class="banners">
        <div class="WSCSlideWrapper">
            <div class="WSCSlide WSCSlideTransition">
                <img class="WSCSlide_img" src="../imgs/comment.png" />
                <img class="WSCSlide_img" src="../imgs/资讯轮播图@2x.png" />
                <img class="WSCSlide_img" src="../imgs/查看报告图2@3x.png" />
            </div>
            <div class="WSCSlideStatus"></div>
        </div>
    </div>
    <ul class="home-list">
        <li class="marginTop1">
            <div class="consult white">
                <div class="consultIn">
                    <h6>宝贝肠绞痛，减轻方案!</h6>
                    <p>多数家长，宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼，如何快速减轻宝宝疼痛，了解</p>
                    <img class="consultImg"  src="../imgs/consult.png" alt="">
                    <div class="c-foot consult-bottom">
                        <div class="c-footIn"><label for="">浏览</label> <span>1234</span></div>
                        <div class="c-footIn"><label for="">浏览</label> <span>456</span></div>
                        <div class="c-footIn"><label for="">浏览</label> <span>123</span></div>
                    </div>
                </div>
            </div>
        </li>
        <li class="marginTop1">
            <div class="consult white">
                <div class="consultIn">
                    <h6>宝贝肠绞痛，减轻方案!</h6>
                    <p>多数家长，宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼宝宝疼很头疼，如何快速减轻宝宝疼痛，了解</p>
                    <img class="consultImg"  src="../imgs/consult.png" alt="">
                    <div class="c-foot consult-bottom">
                        <div class="c-footIn"><label for="">浏览</label> <span>1234</span></div>
                        <div class="c-footIn"><label for="">浏览</label> <span>456</span></div>
                        <div class="c-footIn"><label for="">浏览</label> <span>123</span></div>
                    </div>
                </div>
            </div>
        </li>
    </ul>

</body>
</html>
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script>
<script type="text/javascript">
//    <!--横向滚动-->
    var tabW = $(".tab-btn li").length*80+'px';
    $("#scroller").width(tabW);
    var myScroll = new IScroll('#wrapper', {
        disableMouse: true,
        disablePointer: true,
        scrollX : true,
        scrollY : false,
    });
//    点击事件
    $(".tab-btn li").bind("touchend",function(){
        $(this).addClass("active").siblings().removeClass("active")
});

//    banner
    // 基于jQuery的移动端轮播插件，用zepto会有with问题
    // 返回值  轮播对象
    // 参数：
    // WSCSlideTransition    Transition的class名
    // WSCSlideWrapper    轮播的jQuery对象
    // WSCSlide     包裹轮播图片jQuery对象
    // WSCSlide_img   轮播图片列表jQuery对象
    // timerNum     循环时间
    function WSCMobileSlide(arg_obj) {
        function getTransform(el) {
            var style = window.getComputedStyle($(el).get(0));
            var matrix = new WebKitCSSMatrix(style.webkitTransform);
            return matrix;
        }
        function slideAnimate(x, y) {
            if (Math.abs(x) >= y) {
                $(".WSCSlide").css("-webkit-transform", "translate3d(0,0,0)");
            } else {
                $(".WSCSlide").css("-webkit-transform", "translate3d(" + x + "px,0,0)");
            }
        }

        function getSlideTimer(timeNum) {
            if(typeof(timeNum) == "undefined"){
                timeNum = 3000;
            }
            var slideTimer = setInterval(function() {
                var x = getTransform(".WSCSlide").m41;
                x = x - ImgWidth;
                slideAnimate(x, endPosition);

            }, timeNum);
            return slideTimer;
        }
        function touchDragMe($element) {
            var gundongX = 0;
            var gundongY = 0;
            var d = document;
            var g = 'getElementById';
            var moveEle = $element;
            var stx = sty = etx = ety = curX = curY = 0;
            moveEle.on("touchstart", function(event) { //touchstart
                $element.removeClass(transitionName);
                clearInterval(slideTimer);
                var event = event.originalEvent;
                gundongX = 0;
                gundongY = 0;
                etx = parseInt(getT3d(moveEle, "x"));
                ety = parseInt(getT3d(moveEle, "y"));
                stx = event.touches[0].pageX;
                sty = event.touches[0].pageY;
            });
            moveEle.on("touchmove", function(event) {
                var event = event.originalEvent;
                event.preventDefault();
                gundongX = event.touches[0].pageX - stx;
                gundongY = event.touches[0].pageY - sty;
                curX = gundongX + etx;
                curY = gundongY + ety;

                // 自由移动
                // moveEle.style.webkitTransform = 'translate3d(' + (curX) + 'px, ' + (curY) + 'px,0px)';
                // 只能移动Y轴方向
                // var realMoveEle = moveEle[0];
                moveEle[0].style.webkitTransform = 'translate3d(' + (curX) + 'px, ' + 0 + 'px,0px)';
            });
            moveEle.on("touchend", function(event) {
                var oriX = etx;
                var oriY = ety;
                etx = curX;
                ety = curY;
                var slidePosition = 0;
                for (var i = 0; i < ImgWidth_arr_length - 1; i++) {
                    if (Math.abs(etx) > ImgWidth_arr[i]) {
                        if (oriX > etx) {
                            slidePosition = -ImgWidth_arr[i + 1];
                        } else {
                            slidePosition = -ImgWidth_arr[i];
                        }
                    }
                }
                $element.addClass(transitionName);
                slideAnimate(slidePosition, endPosition);
                slideTimer = getSlideTimer(timerNum);
            });

            function getT3d(elem, ename) {
                var elem = elem[0];
                var str1 = elem.style.webkitTransform;
                if (str1 == "") return "0";
                str1 = str1.replace("translate3d(", "");
                str1 = str1.replace(")", "");
                var carr = str1.split(",");

                if (ename == "x") return carr[0];
                else if (ename == "y") return carr[1];
                else if (ename == "z") return carr[2];
                else return "";
            }
        }
        var transitionName = arg_obj["WSCSlideTransition"] || "WSCSlideTransition";
        var $WSCSlideWrapper = arg_obj["WSCSlideWrapper"] || $(".WSCSlideWrapper");
        var $WSCSlide = arg_obj["WSCSlide"] || $(".WSCSlide");
        var $WSCSlide_img = arg_obj["WSCSlide_img"] || $(".WSCSlide_img");
        var timerNum = arg_obj["timerNum"] || 3000;

        $WSCSlide_img.width($WSCSlideWrapper.width());
        $WSCSlide_img.height($WSCSlideWrapper.height());

        var ImgWidth_arr_length = $WSCSlide_img.length;
        var ImgWidth = $WSCSlide_img.width();


        $WSCSlide.width(ImgWidth * ImgWidth_arr_length);

        var WSCSlideWidth = $WSCSlide.width();
        // 轮播图终止位置
        var endPosition = WSCSlideWidth - ImgWidth;

        var ImgWidth_arr = [];
        for (var i = 0; i < ImgWidth_arr_length; i++) {
            ImgWidth_arr.push(i * ImgWidth);
        }
        // console.log(ImgWidth_arr);

        var slideTimer = getSlideTimer(timerNum);

        touchDragMe($WSCSlide, slideTimer);

        return slideTimer;
    }
    WSCMobileSlide({
        "WSCSlideTransition": "WSCSlideTransition",
        "WSCSlideWrapper": $(".WSCSlideWrapper"),
        "WSCSlide": $(".WSCSlide"),
        "WSCSlide_img": $(".WSCSlide_img"),
        "timerNum": 3000
    });


</script>